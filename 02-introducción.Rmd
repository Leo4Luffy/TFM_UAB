```{r, echo = FALSE}

pacman::p_load(dplyr, ggplot2, showtext, patchwork, latex2exp, gt, ggforce, here, fmsb, readr, tidyr)
font_add_google('Gochi Hand', 'gochi')
showtext_auto()
```

<!-- Para renderizar: bookdown::render_book("index.Rmd", "bookdown::pdf_book") -->

# Revisión de literatura

## Breve historia hacia la selección genómica

La historia de la genética tanto cuantitativa como molecular se remonta a la contribución de muchas personas (Figura 1.1), hecho que permitió la conexión entre ambas disciplinas y el desarrollo de lo que hoy en día se conoce como selección genómica.

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

Linea_1 <- data.frame(x = c(1860, 1920), y = c(1.0, 1.0))
Linea_2 <- data.frame(x = c(1860, 1920), y = c(4.2, 4.2))
Linea_3 <- data.frame(x = c(1960, 2020), y = c(1.0, 1.0))
Linea_4 <- data.frame(x = c(1960, 2020), y = c(4.2, 4.2))
Linea_5 <- data.frame(x = c(1921, 1980), y = c(2.5, 2.5))
Linea_6 <- data.frame(x = c(2016, 2020), y = c(2.5, 2.5))

data.frame(
  x = c(1860, 1870, 1880, 1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020), y = c(-6:10)
  ) %>%
  ggplot(aes(x, y)) +
  #geom_blank() +
  
  geom_line(data = Linea_1, aes(x = x, y = y), size = 1.4) +
  geom_line(data = Linea_3, aes(x = x, y = y), size = 1.4) +
  annotate(geom = 'rect', xmin = 1920, xmax = 1960, ymin = 0.7, ymax = 1.3, colour = 'black', fill = 'black', alpha = 0.1) +
  annotate(geom = 'text', x = 1940, y = 1.0, label = 'Genética cuantitativa', family = 'gochi', size = 3.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1853, xmax = 1879, ymin = -0.7, ymax = -2.5, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'segment', x = 1866, xend = 1866, y = -0.7, yend = 1.0, colour = 'yellow', linetype = 'dashed') +
  annotate(geom = 'text', x = 1866, y = -1.0, label = '1866', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1866, y = -1.4, label = 'Mendel publica', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1866, y = -1.8, label = 'su trabajo sobre', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1866, y = -2.2, label = 'la herencia.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1877, xmax = 1901, ymin = -2.6, ymax = -4.4, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'segment', x = 1889, xend = 1889, y = -2.6, yend = 1.0, colour = 'yellow', linetype = 'dashed') +
  annotate(geom = 'text', x = 1889, y = -2.9, label = '1889', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1889, y = -3.3, label = 'Galton publica', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1889, y = -3.7, label = 'su libro sobre', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1889, y = -4.1, label = 'la herencia.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1904, xmax = 1932, ymin = -2.6, ymax = -4.8, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'segment', x = 1918, xend = 1918, y = -2.6, yend = 1.0, colour = 'yellow', linetype = 'dashed') +
  annotate(geom = 'text', x = 1918, y = -2.9, label = '1918', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1918, y = -3.3, label = 'Fisher establece', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1918, y = -3.7, label = 'el paradigma adi-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1918, y = -4.1, label = 'tivo de la gené-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1918, y = -4.5, label = 'tica cuantitativa.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1894, xmax = 1928, ymin = -0.7, ymax = -2.5, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'segment', x = 1911, xend = 1911, y = -0.7, yend = 1.0, colour = 'yellow', linetype = 'dashed') +
  annotate(geom = 'text', x = 1911, y = -1.0, label = '1911', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1911, y = -1.4, label = 'Morgan permite com-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1911, y = -1.8, label = 'prender como se he-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1911, y = -2.2, label = 'redan los genes.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1937, xmax = 1963, ymin = -0.7, ymax = -2.9, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'segment', x = 1950, xend = 1950, y = -0.7, yend = 0.7, colour = 'yellow', linetype = 'dashed') +
  annotate(geom = 'text', x = 1950, y = -1.0, label = '1950', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1950, y = -1.4, label = 'Henderson deriva', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1950, y = -1.8, label = 'las ecuaciones', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1950, y = -2.2, label = 'del modelo mixto', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1950, y = -2.6, label = 'y el BLUP.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1920, xmax = 1960, ymin = 3.9, ymax = 4.5, colour = 'black', fill = 'black', alpha = 0.1) +
  geom_line(data = Linea_2, aes(x = x, y = y), size = 1.4) +
  geom_line(data = Linea_4, aes(x = x, y = y), size = 1.4) +
  annotate(geom = 'text', x = 1940, y = 4.2, label = 'Genética molecular', family = 'gochi', size = 3.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1854, xmax = 1884, ymin = 5.9, ymax = 7.7, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'segment', x = 1869, xend = 1869, y = 4.2, yend = 5.9, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'text', x = 1869, y = 7.4, label = '1869', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1869, y = 7.0, label = 'Miescher descubre', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1869, y = 6.6, label = 'nucleína (ADN) en', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1869, y = 6.2, label = 'glóbulos blancos.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1923, xmax = 1965, ymin = 8.2, ymax = 10.0, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'segment', x = 1944, xend = 1944, y = 4.5, yend = 8.2, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'text', x = 1944, y = 9.7, label = '1944', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1944, y = 9.3, label = 'Avery, MacLeod y McCar-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1944, y = 8.9, label = 'ty demuestran que el princi-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1944, y = 8.5, label = 'pio transofrmador es el ADN.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1965, xmax = 1989, ymin = 8.2, ymax = 10.0, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'segment', x = 1977, xend = 1977, y = 4.2, yend = 8.3, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'text', x = 1977, y = 9.7, label = '1977', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1977, y = 9.3, label = 'Sanger desarro-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1977, y = 8.9, label = 'lla un método de', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1977, y = 8.5, label = 'secuenciación.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1958, xmax = 1982, ymin = 5.9, ymax = 8.1, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'segment', x = 1970, xend = 1970, y = 4.2, yend = 5.9, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'text', x = 1970, y = 7.8, label = '1970', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1970, y = 7.4, label = 'Wilcox y Smith', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1970, y = 7.0, label = 'caracterizan la', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1970, y = 6.6, label = 'primera enzima', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1970, y = 6.2, label = 'de restricción.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1983, xmax = 2005, ymin = 6.3, ymax = 8.1, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'segment', x = 1984, xend = 1984, y = 4.2, yend = 5.7, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'segment', x = 1984, xend = 1994, y = 5.7, yend = 5.7, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'segment', x = 1994, xend = 1994, y = 5.7, yend = 6.3, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'text', x = 1994, y = 7.8, label = '1984', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 1994, y = 7.4, label = 'Jeffreys in-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1994, y = 7.0, label = 'venta la téc-', size = 2.4, colour = 'black') +
  annotate(geom = 'text', x = 1994, y = 6.6, label = 'nica de PCR.', size = 2.4, colour = 'black') +
  
  annotate(geom = 'segment', x = 1992, xend = 1992, y = 4.2, yend = 5.3, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'segment', x = 1992, xend = 2006, y = 5.3, yend = 5.3, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'segment', x = 2006, xend = 2006, y = 5.3, yend = 9.0, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 1990, xmax = 2022, ymin = 9.0, ymax = 10.0, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'text', x = 2006, y = 9.7, label = '1992', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 2006, y = 9.3, label = 'Se comercializa la RFLP.', size = 2.2, colour = 'black') +
  
  annotate(geom = 'segment', x = 2000, xend = 2000, y = 4.2, yend = 4.8, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'segment', x = 2000, xend = 2018, y = 4.8, yend = 4.8, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'segment', x = 2018, xend = 2018, y = 4.8, yend = 7.4, colour = 'cyan', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 2007, xmax = 2029, ymin = 7.4, ymax = 8.8, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'text', x = 2018, y = 8.5, label = '2000', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 2018, y = 8.1, label = 'Se comercializa', size = 2.2, colour = 'black') +
  annotate(geom = 'text', x = 2018, y = 7.7, label = 'los chips SNP.', size = 2.2, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1980, xmax = 2016, ymin = 2.8, ymax = 2.2, colour = 'black', fill = 'black', alpha = 0.1) +
  geom_line(data = Linea_5, aes(x = x, y = y), size = 1.4) +
  geom_line(data = Linea_6, aes(x = x, y = y), size = 1.4) +
  annotate(geom = 'text', x = 1998, y = 2.5, label = 'Selección genómica', family = 'gochi', size = 3.4, colour = 'black') +
  
  annotate(geom = 'segment', x = 1918, xend = 1921, y = 1.0, yend = 2.5, colour = 'black', linetype = 'twodash') +
  annotate(geom = 'segment', x = 1950, xend = 1953, y = 1.3, yend = 2.5, colour = 'black', linetype = 'twodash') +
  annotate(geom = 'segment', x = 1992, xend = 1995, y = 4.2, yend = 2.8, colour = 'black', linetype = 'twodash') +
  annotate(geom = 'segment', x = 2000, xend = 2003, y = 4.2, yend = 2.8, colour = 'black', linetype = 'twodash') +
  
  scale_x_continuous(limits = c(1850, 2029)) +
  scale_y_continuous(limits = c(-4.8, 10.0)) +
  
  theme_bw() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title = element_blank()) -> Crono

knitr::include_graphics('figures/Crono.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.1:__ Cronología de las disciplinas de la genética molecular y la genética cuantitativa. Varios descubrimientos permitieron la conexión entre ambas disciplinas lo que permitió el desarrollo de la selección genómica. Figura adaptada de @cite:2.
:::

La genética cuantitativa se formo hace más de un siglo en ausencia directa de datos genéticamente observables [@cite:2]. Esta disciplina se formo gracias a los avances teóricos de Ronald Fisher quien proporcionó una teoría que hizo posible interpretar los descubrimientos de la genética biométrica dentro de los estudios de herencia Mendeliana, permitiendo con ello unificar las escuelas de pensamiento Mendeliano y biométrico que para ese entonces estaban en constante debate. Dicha teoría, denominada como teoría del modelo infinitesimal, supuso que la herencia genética es principalmente aditiva, y que la varianza genética de un carácter esta determinada por un gran número de factores Mendelianos (hoy en día conocidos como genes), cada uno de los cuales tiene una pequeña contribución al fenotipo del carácter [@cite:2; @cite:9]. A partir de este entonces, la genética cuantitativa fue extremadamente productiva a medida que fue adhiriéndose a la teoría del modelo infinitesimal.<!-- NOTA: Fisher, en 1918, propuso el modelo que se ha venido usando desde entonces, aproximando el efecto conjunto de los genes de pequeño efecto a una distribución normal, lo que permitió la aplicación de modelos lineales, habituales hoy en día en la selección. -->

Se denomina como valor de cría estimado (EBV) al efecto genético que un individuo posee y que puede transmitir a su descendencia. Este se puede predecir en función de un modelo que relaciona el fenotipo de una población con la información de pedigrí mediante el uso del mejor predictor lineal insesgado (BLUP) [@cite:7]<!-- NOTA:  la forma habitual de resolver el BLUP hoy en día es mediante el uso de las ecuaciones del modelo mixto. -->. Este procedimiento fue resultado del esfuerzo de Charles Roy Henderson quien a inicio de la década de 1950 contribuyó a su desarrollo [@cite:28; @cite:29; @cite:27]. A pesar que desde entonces el BLUP fue el método más utilizado para la mejora genética tanto en animales como en plantas, hoy en día se reconoce que dicho procedimiento ignora la base física de la herencia (el ADN), y utiliza una representación conceptual elemental de como la información genética es heredada (esto es, ambos progenitores deben aportar la mitad de la información genética a su descendencia) [@cite:15].

En otro orden de ideas, el rápido desarrollo de la genética molecular a partir de los años 60 permitió comprender mejor los mecanismos de la herencia. Esta disciplina permitió, a diferencia de la genética cuantitativa, estudiar de forma directa el gen, lo que facilitó a finales de la década de 1970 e inicio de 1980 el descubrimiento de secuencias variables de ADN con fenotipos fácilmente observables [@cite:30]. Son ejemplo de estas secuencias (denominadas como marcadores de ADN) los microsatélites, los polimorfismos en el tamaño de los fragmentos de restricción (RFLP)<!-- NOTA: la RFLP es una técnica que se basa en la detección de fragmentos de ADN de distinto peso molecular (por digestión con la enzima de restricción). --> y los polimorfismos de un sólo nucleótido (SNP), siendo este último hoy en día el principal marcador utilizado para detectar variaciones en el ADN.<!-- NOTA: ¿Por qué los SNP son los más usado? Una razón importante es que los SNP son abundantes, ya que se encuentran en todo el genoma. Otra razón es la ubicación en el ADN: se encuentran en intrones, exones, promotores, potenciadores o regiones intergénicas. Además, los SNP ahora son baratos y fáciles de genotipar de manera automatizada y de alto rendimiento porque son binarios. -->

Dichos marcadores de ADN, al representar las diferencias en el ADN heredado por dos individuos [@cite:15], abrieron la posibilidad de obtener una predicción más precisa de los EBV [@cite:14; @cite:31], comparado al método BLUP mencionado en párrafos anteriores. Según los mismos autores [@cite:31], los primeros intentos de integrar datos de marcadores de ADN en las predicciones se basaron en el supuesto de que era posible encontrar genes que contribuyeran a la variación genética del carácter. Este enfoque, conocido como etiquetado de genes o mapeo de QTL<!-- NOTA: un QTL es un gen que está asociado con la variación en un fenotipo. -->, permitió identificar la genética subyacente a la variación fenotípica de un carácter [@cite:31; @cite:30; @cite:36].

Tanto en animales como en plantas, el interés principal en el mapeo de QTL consistió en usarse en un método conocido como selección asistida por marcadores (MAS) [@cite:3], proceso en el cual los individuos portadores de un marcador de ADN deseado podían ser identificados y seleccionados para aumentar la respuesta genética de caracteres cuantitativos de relevancia económica [@cite:32]<!-- NOTA: la MAS se define como un tipo de selección indirecta basada en la asociación significativa entre un marcador de ADN y la variación de un caracter. -->. @cite:3 describen la MAS como un proceso en el cual se detectan genes que afectan directamente un carácter (QTL), que al ser seleccionados, logran una mejora genética al aumentar su frecuencia (Figura 1.2).

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

Punto_1 <- data.frame(x = c(4.5, 4.5, 3.25), y = c(5.8, -0.2, -0.2))
Punto_2 <- data.frame(x = 5.0, y = 4.8)
Punto_3 <- data.frame(x = c(5.5, 3.25, 2.0), y = c(6.1, 0.7, -0.2))
Punto_4 <- data.frame(x = c(4.5, 3.25), y = c(0.6, 1.5))

data.frame(
  x = c(0.0:10.0), y = c(-0.6:9.4)
  ) %>%
  ggplot(aes(x, y)) +
  #geom_blank() +
  
  annotate(geom = 'rect', xmin = 3.0, xmax = 7.0, ymin = 8.0, ymax = 9.0, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'text', x = 5.0, y = 8.5, label = 'Fenotipos + Genotipos', size = 4.6, colour = 'black') +
  geom_curve(x = 5.0, xend = 5.0, y = 7.8, yend = 7.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  
  annotate(geom = 'rect', xmin = 7.9, xmax = 8.5, ymin = 7.6, ymax = 9.4, colour = 'black', fill = 'white', linetype = 'twodash') +
  annotate(geom = 'text', x = 8.2, y = 8.5, label = 'Mapeo', angle = 90, size = 5.0, colour = 'black') +
  geom_curve(x = 7.7, xend = 7.3, y = 8.5, yend = 8.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  annotate(geom = 'rect', xmin = 4.0, xmax = 6.0, ymin = 3.8, ymax = 6.8, colour = 'black', fill = 'white', linetype = 'dashed') +
  
  geom_point(aes(x = x, y = y), data = Punto_1, size = 11.6, shape = 22, color = 'cyan', fill = 'cyan', alpha = 0.4) +
  annotate(geom = 'text', x = 4.5, y = 5.8, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  
  geom_point(aes(x = x, y = y), data = Punto_2, size = 11.6, shape = 25, color = 'red', fill = 'red', alpha = 0.4) +
  annotate(geom = 'text', x = 5.0, y = 4.8, label = 'QTL', family = 'gochi', angle = 60, size = 3.8, colour = 'black') +
  
  geom_point(aes(x = x, y = y), data = Punto_3, size = 11.6, shape = 21, color = 'orange', fill = 'orange', alpha = 0.4) +
  annotate(geom = 'text', x = 5.5, y = 6.1, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  
  geom_curve(x = 5.0, xend = 5.0, y = 3.6, yend = 2.8, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  
  annotate(geom = 'rect', xmin = 5.5, xmax = 8.5, ymin = 0.75, ymax = 1.75, colour = 'green', fill = 'green', alpha = 0.2) +
  annotate(geom = 'text', x = 7.0, y = 1.25, label = 'Selección', size = 5.0, colour = 'black') +
  
  annotate(geom = 'text', x = 4.5, y = 2.15, label = 'Planta /', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 4.5, y = 1.8, label = 'animal C', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 4.5, y = -0.2, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  geom_point(aes(x = x, y = y), data = Punto_4, size = 11.6, shape = 24, color = 'red', fill = 'red', alpha = 0.4) +
  annotate(geom = 'text', x = 4.5, y = 0.6, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  
  annotate(geom = 'text', x = 3.25, y = 3.05, label = 'Planta /', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 3.25, y = 2.7, label = 'animal B', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 3.25, y = -0.2, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  annotate(geom = 'text', x = 3.25, y = 0.7, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  annotate(geom = 'text', x = 3.25, y = 1.5, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  
  annotate(geom = 'text', x = 2.0, y = 1.15, label = 'Planta /', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 2.0, y = 0.8, label = 'animal A', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 2.0, y = -0.2, label = 'QTL', family = 'gochi', size = 3.8, colour = 'black') +
  
  scale_x_continuous(limits = c(0.0, 10.0)) +
  scale_y_continuous(limits = c(-0.6, 9.4)) +
  
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 14, face = 'bold')) -> MAS

knitr::include_graphics('figures/MAS.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.2:__ Esquema de la MAS. En la MAS, los fenotipos y genotipos de la población de mapeo se analizan usando un modelo estadístico, identificando con ello relaciones significativas entre fenotipos y genotipos. Por último, se seleccionan los individuos favorables con base en datos de genotipo. Figura adaptada de @cite:6.
:::

Si bien la MAS abrió la posibilidad de investigar la variación genética en animales y en plantas, permitiendo también identificar genes que afectaban el desempeño de caracteres económicamente importantes, la literatura científica coincide en afirmar lo limitado que fue esta metodología al no detectar marcadores de ADN con efectos genéticos menores [@cite:3; @cite:10; @cite:32; @cite:7]. Y es que, como es sabido, la mayoría de los caracteres económicamente importantes son cuantitativos y complejos, lo que quiere decir que son caracteres controlados por muchos genes de pequeño efecto y/o por una combinación de genes mayores y menores, lo que hace del la MAS un método poco adecuado para este tipo de arquitectura genética de caracteres.

Finalmente, en el año 2001, Theodorus Meuwissen, Ben Hayes y Michael Goddard presentaron una alternativa a la MAS, superando con ello las limitaciones que suponía el uso de esta metodología. A esta nueva alternativa se le dio el nombre de selección genómica. Solo fue cuestión de tiempo para que los datos obtenidos de la genética molecular se integraran a los modelos estadísticos de la genética cuantitativa, permitiendo así el análisis de caracteres complejos en el marco de efectos del modelo infinitesimal.

## La selección genómica

### Definición de la selección genómica

Se denomina selección genómica a una serie de métodos que usan decenas de miles de marcadores de ADN, principalmente SNP, para realizar la predicción del EBV (aunque en selección genómica es común referirse al EBV como valor de cría basado en marcadores de ADN o GEBV). @cite:3 y @cite:33 describen este método como un proceso en el cual se usan grandes cantidades de marcadores de ADN <!--(teniendo en cuenta también el desequilibrio de ligamiento entre dichos marcadores)--> para construir un modelo de relaciones genotipo-fenotipo en una población de entrenamiento. Luego el modelo de selección genómica resultante se utiliza en una población de prueba que solo está genotipada, y se predice en ella el GEBV con el que se lleva a cabo la selección (Figura 1.3). Por tanto, la selección genómica suele ser vista como una forma de MAS en la que se seleccionan individuos según el GEBV en lugar de pocos QTL [@cite:6].

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

data.frame(
  x = c(0.0:10.0), y = c(0.0:10.0)
  ) %>%
  ggplot(aes(x, y)) +
  #geom_blank() +
  
  annotate(geom = 'rect', xmin = 3.0, xmax = 7.0, ymin = 7.0, ymax = 9.0, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'text', x = 5.0, y = 8.355, label = 'Modelo de sele-', size = 5.0, colour = 'black') +
  annotate(geom = 'text', x = 5.0, y = 7.625, label = 'cción genómica', size = 5.0, colour = 'black') +
  geom_curve(x = 5.0, xend = 5.0, y = 6.8, yend = 6.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'text', x = 2.1, y = 8.5, label = 'Fenotipo', size = 5.0, colour = 'black') +
  geom_curve(x = 1.2, xend = 2.8, y = 8.2, yend = 8.2, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  annotate(geom = 'text', x = 2.1, y = 7.77, label = 'Genotipo', size = 4.6, colour = 'black') +
  geom_curve(x = 1.2, xend = 2.8, y = 7.47, yend = 7.47, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  annotate(geom = 'rect', xmin = 3.0, xmax = 7.0, ymin = 4.8, ymax = 5.8, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'text', x = 5.0, y = 5.3, label = 'Predicción', size = 4.6, colour = 'black') +
  geom_curve(x = 5.0, xend = 5.0, y = 4.6, yend = 3.8, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'text', x = 2.1, y = 5.445, label = 'Genotipo', size = 4.6, colour = 'black') +
  geom_curve(x = 1.2, xend = 2.8, y = 5.145, yend = 5.145, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  annotate(geom = 'rect', xmin = 5.5, xmax = 8.5, ymin = 2.6, ymax = 3.6, colour = 'green', fill = 'green', alpha = 0.2) +
  annotate(geom = 'text', x = 7.0, y = 3.1, label = 'Selección', size = 5.0, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 4.0, xmax = 5.0, ymin = 2.0, ymax = 2.75, colour = 'black', fill = 'black', alpha = 0.2) +
  annotate(geom = 'text', x = 4.5, y = 2.25, label = 'GEV', family = 'gochi', size = 4.8, colour = 'black') +
  annotate(geom = 'text', x = 4.5, y = 3.35, label = 'Planta /', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 4.5, y = 3.05, label = 'animal C', size = 4.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 2.75, xmax = 3.75, ymin = 2.0, ymax = 3.25, colour = 'black', fill = 'black', alpha = 0.2) +
  annotate(geom = 'text', x = 3.25, y = 2.25, label = 'GEV', family = 'gochi', size = 4.8, colour = 'black') +
  annotate(geom = 'text', x = 3.25, y = 3.85, label = 'Planta /', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 3.25, y = 3.55, label = 'animal B', size = 4.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1.5, xmax = 2.5, ymin = 2.0, ymax = 2.5, colour = 'black', fill = 'black', alpha = 0.2) +
  annotate(geom = 'text', x = 2.0, y = 2.25, label = 'GEV', family = 'gochi', size = 4.8, colour = 'black') +
  annotate(geom = 'text', x = 2.0, y = 3.1, label = 'Planta /', size = 4.4, colour = 'black') +
  annotate(geom = 'text', x = 2.0, y = 2.8, label = 'animal A', size = 4.4, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 7.9, xmax = 8.5, ymin = 6.45, ymax = 9.55, colour = 'black', fill = 'white', linetype = 'twodash') +
  annotate(geom = 'text', x = 8.2, y = 8.0, label = 'Entrenamiento', angle = 90, size = 5.0, colour = 'black') +
  geom_curve(x = 7.7, xend = 7.3, y = 8.0, yend = 8.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  annotate(geom = 'rect', xmin = 7.9, xmax = 8.5, ymin = 4.5, ymax = 6.1, colour = 'black', fill = 'white', linetype = 'twodash') +
  annotate(geom = 'text', x = 8.2, y = 5.3, label = 'Prueba', angle = 90, size = 5.0, colour = 'black') +
  geom_curve(x = 7.7, xend = 7.3, y = 5.3, yend = 5.3, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  scale_x_continuous(limits = c(0.0, 10.0)) +
  scale_y_continuous(limits = c(2.0, 9.55)) +
  
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 14, face = 'bold')) -> GS

knitr::include_graphics('figures/GS.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.3:__ Esquema de la selección genómica. La selección genómica utiliza un modelo estadístico, diseñado a partir de datos genotípicos y fenotípicos en una población de entrenamiento, para predecir el GEBV de los individuos en una población de prueba con datos genotípicos. Por último, los individuos se seleccionan de acuerdo a su GEBV. Figura adaptada de @cite:7.
:::

El uso de decenas de miles de marcadores de ADN es una de las características fundamentales de la selección genómica [@cite:10]. Al contar con tal cantidad, la probabilidad de que algunos de estos marcadores estén en desequilibrio de ligamiento con el QTL tiende a aumentar [@cite:8], con lo cual, aún cuando dichos marcadores no tienen efecto biológico sobre el carácter, a partir de este hecho biológico si que se garantizaría una asociación (no observada) entre el QTL y el carácter [@cite:30; @cite:35; @cite:36].

### Métodos estadísticos en la selección genómica

En la selección genómica, la relación genotipo-fenotipo puede ser representada como un modelo lineal (Figura 1.4). Por tanto, el modelo de regresión lineal es un enfoque fundamental en la selección genómica [@cite:6; @cite:31; @cite:37].

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

Gen_1 <- data.frame(
  x = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.55, 0.55, 0.55, 0.55, 0.55, 0.55, 0.6, 0.6, 0.6, 0.6, 0.65, 0.65), y = c(0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.45, 0.5, 0.55, 0.6, 0.5, 0.55), Genotipos = '0'
  )

Gen_2 <- data.frame(
  x = c(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.05, 1.05, 1.05, 1.05, 1.05, 1.05, 1.1, 1.1, 1.1, 1.1, 1.15, 1.15), y = c(0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.15, 1.2, 1.25, 1.3, 1.2, 1.25), Genotipos = '1'
  )

Gen_1_Gen_2 <- bind_rows(Gen_1, Gen_2)

ggplot(data = Gen_1_Gen_2, aes(x = x, y = y, colour = Genotipos, fill = Genotipos)) +
  
  annotate(geom = 'rect', xmin = 0.49, xmax = 0.52, ymin = 0.225, ymax = 0.325, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.49, xmax = 0.57, ymin = 0.325, ymax = 0.425, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.49, xmax = 0.67, ymin = 0.425, ymax = 0.525, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.49, xmax = 0.67, ymin = 0.525, ymax = 0.625, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.49, xmax = 0.57, ymin = 0.625, ymax = 0.725, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.49, xmax = 0.52, ymin = 0.725, ymax = 0.825, colour = 'black', fill = 'white', linetype = 'dashed') +
  
  annotate(geom = 'rect', xmin = 0.99, xmax = 1.02, ymin = 0.925, ymax = 1.025, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.99, xmax = 1.07, ymin = 1.025, ymax = 1.125, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.99, xmax = 1.17, ymin = 1.125, ymax = 1.225, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.99, xmax = 1.17, ymin = 1.225, ymax = 1.325, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.99, xmax = 1.07, ymin = 1.325, ymax = 1.425, colour = 'black', fill = 'white', linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.99, xmax = 1.02, ymin = 1.425, ymax = 1.525, colour = 'black', fill = 'white', linetype = 'dashed') +
  
  annotate(geom = 'segment', x = 0.25, xend = 1.35, y = 0.3, yend = 1.5, colour = 'black', size = 1.4) +
  
  geom_point(alpha = 0.5, size = 3.4) +
  
  annotate(geom = 'text', x = 1.51, y = 1.44, label = TeX('$y_{i} = \\mu + x_{i1}g_{1}$'), size = 4.8) +
  
  scale_colour_manual(values = c('yellow', 'cyan')) +
  scale_fill_manual(values = c('yellow', 'cyan')) +
  
  labs(x = 'Genotipo', y = 'Fenotipo') +
  
  scale_x_continuous(limits = c(0.20, 1.75)) +
  scale_y_continuous(limits = c(0.15, 1.65)) +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_text(size = 14,face = 'bold'),
        legend.background = element_rect(color = 'gray34', fill = 'white', size = 0.4, linetype = 'dashed'),
        legend.position = c(0.84, 0.24),
        legend.title = element_text(size = 14, face = 'bold'),
        legend.text = element_text(size = 14)) -> Mod_RL

knitr::include_graphics('figures/Mod_RL.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.4:__ Relación genotipo-fenotipo de individuos (circulos amarillo y azul) <!--en una población de entrenamiento -->para un solo marcador. $Y_{i}$ y $x_{i1}$ denotan los fenotipos y genotipos, y $\mu$ y $g_{i}$ son los parámetros a determinar. Los genotipos bialélicos se codifican como 0 y 1, y los fenotipos se distribuyen de acuerdo a una normal. Figura adaptada de @cite:6.
:::

Dicha relación genotipo-fenotipo se puede expresar de la forma:

\begin{equation}
y_{i} = \mu + \sum_{j = 1}^{p}x_{ij}g_{j} + e_{i},
\end{equation}

donde $i$ ($1, 2, 3, …, n$) representa a los individuos, $j$ ($1, 2, 3, …, p$) corresponde a los marcadores, $y_{i}$ denota el fenotipo para el *i*-ésimo individuo, $\mu$ corresponde a la media de la población, $x_{ij}$ representa al genotipo del *j*-ésimo marcador en el *i*-ésimo individuo, $g_{j}$ corresponde al efecto del *j*-ésimo marcador en el fenotipo, y $e_{i}$ es el término del error. <!--Aquí, $\mu$ y $g_{j}$ son los parámetros a determinar, y esto se realiza por mínimos cuadrados.-->

Así mismo, el modelo anterior se puede expresar en notación matricial como:

\begin{equation}
y = Zg + e,
\end{equation}

donde $y$ es un vector de longitud igual al número de individuos ($1, 2, 3, …, n$) que representa al fenotipo, $Z$ es una matriz que indica si el marcador es homocigoto dominante, heterocigoto u homocigoto recesivo (por ejemplo, 2 si es homocigoto dominante, 1 si es heterocigoto y 0 si es homocigoto recesivo), $g$ es un vector de efectos del marcador en el fenotipo (tratados aquí como efectos fijos), y $e$ es el término del error. Luego el GEBV se puede predecir como $\hat{g} = (Z'Z)^{- 1} Z'y$ mediante mínimos cuadrados<!--, buscando así que dicha predicción sea próxima al verdadero valor ($g$)-->.<!-- NOTA: tal como está, X'X no se puede invertir. Esto se debe a que los parámetros, incluidos los valores genéticos, no son independientes. ay dos formas principales para contabilizar esta dependencia: 1- Tratar los valores genéticos a estimar como desviaciones de una media general; 2- Tratar uno de los efectos estimados como referencia y medir todos los demás efectos como desviaciones de la referencia. Creo que esta segunda forma es como aparece en la figura de Nakaya e Isobe, donde beta0 sería el efecto de referencia a partir del cual se mide beta 1. -->

Sin embargo, con el uso decenas de miles de marcadores de ADN para predecir el GEBV, al emplear el modelo lineal en selección genómica puede surgir un problema conocido como p grande y n pequeño [@cite:6; @cite:31; @cite:7], hecho que puede afectar el uso de la regresión por mínimos cuadrados, ya que esta solo se puede aplicar en situaciones en las que el número de observaciones es mayor al número de variables o predictores. En tal sentido, la selección genómica brinda la oportunidad de enfrentar el problema del p grande y n pequeño por medio del uso de modelos de regresión lineal alternativos (Figura 1.5).

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

data.frame(
  x = c(0.0:10.0), y = c(0.0:10.0)
  ) %>%
  ggplot(aes(x, y)) +
  #geom_blank() +
  
  annotate(geom = 'rect', xmin = 3.3, xmax = 6.7, ymin = 8.0, ymax = 9.0, colour = 'black', fill = 'black', alpha = 0.2) +
  annotate(geom = 'text', x = 5.0, y = 8.7, label = 'Modelos de', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 5.0, y = 8.3, label = 'regresión', size = 3.4, colour = 'black') +
  annotate(geom = 'segment', x = 5.0, xend = 5.0, y = 8.0, yend = 7.5, colour = 'black') +
  annotate(geom = 'segment', x = 5.0, xend = 2.5, y = 7.5, yend = 7.5, colour = 'black') +
  annotate(geom = 'segment', x = 5.0, xend = 7.5, y = 7.5, yend = 7.5, colour = 'black') +
  annotate(geom = 'segment', x = 2.5, xend = 2.5, y = 7.5, yend = 7.0, colour = 'black') +
  annotate(geom = 'rect', xmin = 0.15, xmax = 4.85, ymin = 6.0, ymax = 7.0, colour = 'black', fill = 'black', alpha = 0.2) +
  annotate(geom = 'text', x = 2.5, y = 6.7, label = 'Modelos lineales', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 2.5, y = 6.3, label = 'mixtos', size = 3.4, colour = 'black') +
  annotate(geom = 'segment', x = 7.5, xend = 7.5, y = 7.5, yend = 7.0, colour = 'black') +
  annotate(geom = 'rect', xmin = 5.15, xmax = 9.85, ymin = 6.4, ymax = 7.0, colour = 'black', fill = 'black', alpha = 0.2) +
  annotate(geom = 'text', x = 7.5, y = 6.7, label = 'Bayesianos', size = 3.4, colour = 'black') +
  
  annotate(geom = 'segment', x = 1.25, xend = 1.25, y = 6.0, yend = 4.7, colour = 'black') +
  geom_curve(x = 1.25, xend = 1.75, y = 5.3, yend = 5.3, arrow = arrow(length = unit(0.1, 'inch')), size = 0.2, color = 'black', curvature = 0.0, linetype = 'solid') +
  annotate(geom = 'text', x = 2.8, y = 5.3, label = 'rrBLUP', size = 3.4, colour = 'black') +
  geom_curve(x = 1.25, xend = 1.75, y = 4.7, yend = 4.7, arrow = arrow(length = unit(0.1, 'inch')), size = 0.2, color = 'black', curvature = 0.0, linetype = 'solid') +
  annotate(geom = 'text', x = 2.8, y = 4.7, label = 'GBLUP', size = 3.4, colour = 'black') +
  
  annotate(geom = 'segment', x = 6.25, xend = 6.25, y = 6.4, yend = 3.9, colour = 'black') +
  geom_curve(x = 6.25, xend = 6.75, y = 5.7, yend = 5.7, arrow = arrow(length = unit(0.1, 'inch')), size = 0.2, color = 'black', curvature = 0.0, linetype = 'solid') +
  annotate(geom = 'text', x = 7.8, y = 5.7, label = 'BayesA', size = 3.4, colour = 'black') +
  geom_curve(x = 6.25, xend = 6.75, y = 5.1, yend = 5.1, arrow = arrow(length = unit(0.1, 'inch')), size = 0.2, color = 'black', curvature = 0.0, linetype = 'solid') +
  annotate(geom = 'text', x = 7.8, y = 5.1, label = 'BayesB', size = 3.4, colour = 'black') +
  geom_curve(x = 6.25, xend = 6.75, y = 4.5, yend = 4.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.2, color = 'black', curvature = 0.0, linetype = 'solid') +
  annotate(geom = 'text', x = 7.8, y = 4.5, label = 'BayesC', size = 3.4, colour = 'black') +
  geom_curve(x = 6.25, xend = 6.75, y = 3.9, yend = 3.9, arrow = arrow(length = unit(0.1, 'inch')), size = 0.2, color = 'black', curvature = 0.0, linetype = 'solid') +
  annotate(geom = 'text', x = 7.8, y = 3.9, label = 'LASSO', size = 3.4, colour = 'black') +
  
  scale_x_continuous(limits = c(0.0, 10.0)) +
  scale_y_continuous(limits = c(3.65, 9.15)) +
  
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank()) -> Mod_GS

set.seed(1234)

ggplot() +
  xlim(-4, 4) +
  geom_function(fun = dnorm, colour = 'yellow', size = 1.2) +
  labs(title = 'rrBLUP - GBLUP') +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 10, face = 'bold')) -> Dist_1

ggplot() +
  xlim(-4, 4) +
  geom_function(fun = function(x) 0.5*exp(-abs(x)), colour = 'cyan', size = 1.2) +
  labs(title = 'BayesA - LASSO') +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 10, face = 'bold')) -> Dist_2

ggplot() +
  xlim(-4, 4) +
  theme_bw() +
  labs(title = 'BayesB - BayesC') +
  annotate(geom = 'segment', x = -4.0, xend = 0.0, y = -4.0, yend = -3.0, colour = 'red', size = 1.2) +
  annotate(geom = 'segment', x = 4.0, xend = 0.0, y = -4.0, yend = -3.0, colour = 'red', size = 1.2) +
  annotate(geom = 'segment', x = 0.0, xend = 0.0, y = -3.0, yend = 4.0, colour = 'red', size = 1.2) +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 10, face = 'bold')) -> Dist_3

ggplot() +
  xlim(-4, 4) +
  geom_blank() +
  theme_void() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 10, face = 'bold')) -> Dist_4

(Mod_GS) | ( ( Dist_1 | Dist_2 ) / ( Dist_3 | Dist_4 ) ) -> Mod_GS 

knitr::include_graphics('figures/Mod_GS.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.5:__ Enfoques estadísticos de la selección genómica. Cada uno de estos enfoques suponen distintas distribuciones de efectos de los marcadores sobre el carácter. Figura adaptada de @cite:31 y de @cite:7.
:::

Al proponer la teoría de la selección genómica, @cite:8 proporcionaron también una serie de métodos estadísticos como solución al problema planteado en el párrafo anterior, esto es, el mejor predictor lineal insesgado por regresión de crestas (rrBLUP), y los métodos Bayesianos BayesA y BayesB.

En relación al rrBLUP, este se puede expresar como un modelo lineal mixto:

\begin{equation}
y = Xb + Zg + e,
\end{equation}

donde $y$, $Z$ y $e$ denotan los mismos términos del modelo (1.2), $g$ es un vector de efectos del marcador en el fenotipo (tratados aquí como efectos aleatorios), $X$ es una matriz que indica los efectos fijos y $b$ es un vector de efector fijos. Luego la predicción del GEBV se realiza a partir de $\hat{g} = (Z'Z + I \lambda)^{- 1} Z'y$, donde $I$ es una matriz identidad y $\lambda$ es un factor de penalización que se agrega a la diagonal de $Z'Z$, y permite estimar cualquier número de efectos de marcador. Dicho factor de penalización se estima por máxima verosimilitud restringida (REML) como $\frac{\sigma^{2}_{e}} {\sigma^{2}_{g}}$ <!-- es decir, la relación entre los dos componentes de varianza del efecto aleatorio -->, donde $\sigma^{2}_{g}$ es la varianza del efecto del marcador y $\sigma^{2}_{e}$ es la varianza del error residual. En el rrBLUP, se asume que todos los marcadores explican cantidades iguales de variación genética (esto es, varianza común para el efecto del marcador) y supone que sus efectos son normalmente distribuidos [@cite:7].

Con respecto a los métodos Bayesianos, estos, a diferencia del método anterior, no asumen una distribución normal de los efectos de los marcadores, sino que en su lugar permiten que una parte de dichos marcadores tengan efectos importantes sobre el carácter, permitiendo así efectos del marcador diferentes [@cite:38].

Los modelos de regresión Bayesianos (BayesA y BayesB) propuestos por @cite:8, se diferencian en los distintos supuestos sobre los efectos del marcador y sus distribuciones. De acuerdo a @cite:21, en BayesA se supone que los efectos de los marcadores se distribuyen de acuerdo a una distribución t de Student en lugar de una normal, permitiendo así que algunos marcadores tengan efectos grandes, otros medianos y otros pequeños. En cuanto a BayesB, este presenta los mismos supuestos de BayesA, sin embargo, a diferencia de este último, en BayesB se permite que una parte de los marcadores no tengan efecto alguno sobre el carácter [@cite:21]. De la misma manera, BayesA y BayesB se diferencian en el procedimiento de estimación: BayesA utiliza el método de cadenas de Markov Monte Carlo (MCMC) para ... [@cite:34].

Sobre la base de los dos modelos de regresión Bayesianos propuestos por @cite:8, se han desarrollado una gran variedad de modelos Bayesianos para la predicción del GEBV. Por ejemplo en BayesC, se supone que todos los marcadores se distribuyen de forma normal (como la rrBBLUP), sin embargo, al igual que en BayesB, se permite que un porcentaje de los marcadores no tengan efecto sobre el carácter [@cite:21]. Por otro lado, en el LASSO Bayesiano se supone que el efecto del marcador obedece a una distribución de Laplace, distribución que comparte las mismas características de la t de Student en BayesA al suponer que todos los marcadores tienen un efecto distinto de cero y con diferentes varianzas [@cite:34].

Un modelo de regresión equivalente al rrGBLUP, denominado como mejor predictor lineal insesgado genómico (GBLUP), fue propuesto por @cite:39. En el GBLUP, se utiliza una matriz de parentesco basada en marcadores de ADN (denominada como matriz G) en lugar de la matriz de parentesco basado en pedigríes (denominada como matriz A) del BLUP descrito por @cite:41. Luego la predicción del GEBV se realiza mediante un modelo lineal mixto, cuyas ecuaciones son:

\begin{equation}
\begin{bmatrix}
X'X & X'Z \\
Z'X & Z'Z + G^{-1} \lambda
\end{bmatrix}
\begin{bmatrix}
\hat{b} \\
\hat{g}
\end{bmatrix}
=
\begin{bmatrix}
X'y \\
Z'y
\end{bmatrix}
,
\end{equation}

donde $X$, $Z$, $b$, $g$ y $\lambda$ denotan los mismos términos de los modelos (1.2) y (1.3), y $G^{-1}$ corresponde a la inversa de la matriz G. El GBLUP, al igual que el rrBLUP, supone una varianza común para el efecto del marcador y que el efecto de los marcadores están normalmente distribuidos.

La idea de @cite:39, al sustituir la matriz A por la matriz G, consistió en precisar el parentesco real entre individuos al momento de estimar los valores de cría. Según @cite:21, el parentesco que proviene al usar la matriz A es un parentesco esperado, lo cual puede no reflejar el porcentaje real de genes idénticos entre dos individuos emparentados, caso contrario al parentesco derivado al usar la matriz G que es observado, debido a lo cual si puede evidenciar de forma precisa el parentesco real entre dos individuos (Figura 1.6).

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE, warning = FALSE}

Puntos <- data.frame(x = c(0.75, 0.25, 1.75, 0.75, 1.75), y = c(1.75, 1.4, 1.4, 1.05, 1.05))
Cuadros <- data.frame(x = c(1.25, 0.75, 1.25, 0.25, 1.25), y = c(1.75, 1.4, 1.4, 1.05, 1.05))

data.frame(x = c(3.7, 4.3, 4.0, 3.4, 4.6), y = c(1.5, 1.5, 0.9, 0.9, 0.9)) %>%
  
  ggplot(aes(x0 = x, y0 = y, r = 0.4)) +
  
  #annotate(geom = 'rect', xmin = 0.05, xmax = 1.95, ymin = 0.05, ymax = 1.95, colour = 'black', fill = 'white', size = 0.2, linetype = 'solid') +
  annotate(geom = 'segment', x = 0.55, xend = 0.55, y = 1.95, yend = 1.25, colour = 'black', size = 0.2, linetype = 'dashed') +
  annotate(geom = 'segment', x = 0.55, xend = 1.95, y = 1.25, yend = 1.25, colour = 'black', size = 0.2, linetype = 'dashed') +
  annotate(geom = 'segment', x = 1.95, xend = 1.95, y = 1.95, yend = 1.25, colour = 'black', size = 0.2, linetype = 'dashed') +
  
  geom_point(aes(x = x, y = y), data = Puntos, size = 11.6, shape = 21, color = 'black', fill = 'white', alpha = 0.5) +
  geom_point(aes(x = x, y = y), data = Cuadros, size = 11.6, shape = 22, color = 'black', fill = 'white', alpha = 0.5) +
  
  annotate(geom = 'segment', x = 0.85, xend = 1.15, y = 1.75, yend = 1.75, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 1.0, xend = 1.0, y = 1.75, yend = 1.6, colour = 'black', size = 0.8, linetype = 'solid') +
  
  annotate(geom = 'segment', x = 0.25, xend = 1.75, y = 1.6, yend = 1.6, colour = 'black', size = 0.8, linetype = 'solid') +
  
  annotate(geom = 'segment', x = 0.25, xend = 0.25, y = 1.6, yend = 1.5, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 0.75, xend = 0.75, y = 1.6, yend = 1.5, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 1.25, xend = 1.25, y = 1.6, yend = 1.5, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 1.75, xend = 1.75, y = 1.6, yend = 1.5, colour = 'black', size = 0.8, linetype = 'solid') +
  
  annotate(geom = 'segment', x = 1.75, xend = 1.75, y = 1.3, yend = 1.15, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 1.25, xend = 1.25, y = 1.3, yend = 1.15, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 0.75, xend = 0.75, y = 1.3, yend = 1.15, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 0.25, xend = 0.25, y = 1.3, yend = 1.15, colour = 'black', size = 0.8, linetype = 'solid') +
  
  annotate(geom = 'text', x = 0.75, y = 1.75, label = '1', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 1.25, y = 1.75, label = '2', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.25, y = 1.4, label = '3', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 1.4, label = '4', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 1.25, y = 1.4, label = '5', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 1.75, y = 1.4, label = '6', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.25, y = 1.05, label = '7', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 1.05, label = '8', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 1.25, y = 1.05, label = '9', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 1.75, y = 1.05, label = '10', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 3.05, xmax = 4.95, ymin = 0.05, ymax = 1.95, colour = 'black', fill = 'white', size = 0.2, linetype = 'solid') +
  
  annotate(geom = 'segment', x = 1.95, xend = 3.05, y = 1.25, yend = 0.05, colour = 'black', size = 0.2, linetype = 'dashed') +
  annotate(geom = 'segment', x = 0.55, xend = 3.35, y = 1.95, yend = 1.95, colour = 'black', size = 0.2, linetype = 'dashed') +
  
  geom_circle(aes(x0 = x, y0 = y, r = 0.2), colour = 'yellow', fill = 'yellow', alpha = 0.2, size = 0.4) +
  
  annotate(geom = 'segment', x = 3.63, xend = 3.77, y = 1.55, yend = 1.55, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 3.63, xend = 3.77, y = 1.45, yend = 1.45, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'text', x = 3.7, y = 1.6, label = 'A1', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 3.7, y = 1.4, label = 'A2', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'segment', x = 4.23, xend = 4.37, y = 1.55, yend = 1.55, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 4.23, xend = 4.37, y = 1.45, yend = 1.45, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'text', x = 4.3, y = 1.6, label = 'A1', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 4.3, y = 1.4, label = 'A2', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'segment', x = 3.93, xend = 4.07, y = 0.95, yend = 0.95, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 3.93, xend = 4.07, y = 0.85, yend = 0.85, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'text', x = 4.0, y = 1.0, label = 'A1', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 4.0, y = 0.8, label = 'A1', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'segment', x = 3.33, xend = 3.47, y = 0.95, yend = 0.95, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 3.33, xend = 3.47, y = 0.85, yend = 0.85, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'text', x = 3.4, y = 1.0, label = 'A1', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 3.4, y = 0.8, label = 'A1', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'segment', x = 4.53, xend = 4.67, y = 0.95, yend = 0.95, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'segment', x = 4.53, xend = 4.67, y = 0.85, yend = 0.85, colour = 'black', size = 0.8, linetype = 'solid') +
  annotate(geom = 'text', x = 4.6, y = 1.0, label = 'A2', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 4.6, y = 0.8, label = 'A2', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'text', x = 4.0, y = 1.5, label = 'X', size = 5.2, colour = 'black') +
  geom_curve(x = 4.0, xend = 4.0, y = 1.4, yend = 1.2, arrow = arrow(length = unit(0.1, 'inch')), size = 0.7, color = 'black', curvature = 0.0, linetype = 'dashed') +
  
  annotate(geom = 'rect', xmin = 3.35, xmax = 3.95, ymin = 0.4, ymax = 0.5, colour = 'black', fill = 'white', size = 0.2, linetype = 'solid') +
  annotate(geom = 'text', x = 3.65, y = 0.45, label = TeX('$f_{4 5} = 1.0$'), size = 4.2) +
  
  annotate(geom = 'rect', xmin = 4.05, xmax = 4.65, ymin = 0.4, ymax = 0.5, colour = 'black', fill = 'white', size = 0.2, linetype = 'solid') +
  annotate(geom = 'text', x = 4.35, y = 0.45, label = TeX('$f_{5 6} = 0.0$'), size = 4.2) +
  
  scale_x_continuous(limits = c(0.0, 5.0)) +
  scale_y_continuous(limits = c(0.0, 2.0)) +
  
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank()) -> Ped

knitr::include_graphics('figures/Ped.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.6:__ Parentesco observado entre individuos emparentados.
:::

<!--
Suponiendo que se tiene la siguiente información:

+ Información de pedigrí

```{r, fig.align = 'center', echo = FALSE, eval = TRUE}

tribble(
  ~'ID', ~'Padre', ~'Madre',
  '1', '-', '-',
  '2', '-', '-',
  '3', '1', '2',
  '4', '1', '2',
  '5', '1', '2',
  '6', '1', '2',
  '7', '3', '-',
  '8', '-', '4',
  '9', '5', '-',
  '10', '-', '6'
  ) %>%
  gt()
```

+ Información sobre marcadores de ADN (SNP)

```{r, fig.align = 'center', echo = FALSE, eval = TRUE}

tribble(
  ~'ID', ~'SNP',
  '1', 'A1A2',
  '2', 'A1A2',
  '4', 'A1A1',
  '5', 'A1A1',
  '6', 'A2A2'
  ) %>%
  gt()
```

El calculo del parentesco geneálogico se realiza previa estimación de la matriz A, y luego usando la expresión $f_{ij} = \frac{Aij}{2}$. Así por ejemplo, el parentesco geneálogico entre los individuos 4 y 5, y 5 y 6 es $f = \frac{0.5}{2} = 0.25$.

El calculo del parentesco molecular se realiza comparando los alelos que comparten dos individuos:

A1A1, A1A1 -> 4/4 = 1.0 entre los individuos 4 y 5.
A1A1, A2A2 -> 0/4 = 0.0 entre los individuos 5 y 6.
-->

En comparación a los métodos Bayesianos descritos anteriormente, en el GBLUP no es necesario usar una población de entrenamiento para estimar el efecto del marcador de ADN y luego predecir el GEBV. En su lugar, en el GBLUP se pueden colocar directamente a los individuos con fenotipo y sin fenotipo en el mismo modelo, y al mismo tiempo predecir el GEBV, y calcular su precisión [@cite:34]. En cuanto a la velocidad de calculo, el GBLUP es mucho más rápido que los método Bayesianos, por lo que es más adecuado para obtener rápidamente el GEBV. Sin embargo, los métodos Bayesianos permiten incorporar al modelo información previa proveniente de múltiples estudios, siendo esto una ventaja de los mismos sobre otros métodos como el GBLUP. En tal sentido, @cite:31 proporcionan algunos ejemplos sobre que tipo de información se podría incorporar a los efectos previos asignado a los marcadores, por mencionar algunos de ellos, la ubicación del marcador en el genoma, si dicha ubicación corresponde a una región codificante o no, y si el marcador esta en una región del genoma que alberga genes que pueden afectar una carácter de interés.

### De la selección genómica de múltiples pasos a un solo paso

Para implementar los métodos de selección genómica mencionados anteriormente (rrBLUP,  BayesA-B-C, LASSO Bayesiano y GBLUP), es necesario disponer de información genotípica y fenotípica ya que los modelos estadísticos generalmente se construyen en base a esta información. Esta situación puede ser desventajosa al momento de implementar la selección genómica, ya que por lo general no todos los individuos pueden genotiparse y en ocasiones (principalmente en animales) no se tienen valores fenotípicos para caracteres de interés (por ejemplo, la producción de leche en machos) [@cite:17; @cite:31; @cite:11; @cite:21]. Como solución al problema de la falta de fenotipos, @cite:39, con la implementación del GBLUP, propuso asignarle pseudo-fenotipos o valores de-regresados (estos son, valores fenotípicos  estimados a partir de los EBV) a aquellos individuos con fenotipos faltantes, basándose en la información de sus parientes, permitiendo de esta forma implementar la selección genómica combinando los EBV y los genotipos a través de múltiples pasos (Figura 1.7) [@cite:17; @cite:16; @cite:14; @cite:15; @cite:18].

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

Punto <- data.frame(x = 6.3, y = 2.2)
Puntos <- data.frame(x = c(6.3, 6.0, 6.6, 6.15, 6.45), y = c(3.8, 3.8, 3.8, 3.4, 3.4))

data.frame(
  x = 4.5, y = 1.5
  ) %>%
  ggplot(aes(x0 = x, y0 = y, r = 0.8)) +
  #geom_blank() +
  
  annotate(geom = 'rect', xmin = 2.5, xmax = 4.75, ymin = 6.0, ymax = 9.5, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'text', x = 3.625, y = 7.75, label = 'A', size = 6.4, colour = 'black') +
  annotate(geom = 'text', x = 2.1, y = 7.75, label = 'Matriz A', size = 4.6, angle = 90, colour = 'black') +
  geom_curve(x = 3.625, xend = 4.5, y = 5.7, yend = 4.3, arrow = arrow(length = unit(0.05, 'inch')), size = 0.2, color = 'black', curvature = 0.0) +
  
  annotate(geom = 'rect', xmin = 3.5, xmax = 5.5, ymin = 4.0, ymax = 2.0, colour = 'black', fill = 'black', alpha = 0.4) +
  annotate(geom = 'rect', xmin = 4.4, xmax = 4.6, ymin = 2.0, ymax = 1.5, colour = 'black', fill = 'black', alpha = 0.7) +
  geom_circle(aes(x0 = x, y0 = y, r = 0.2), colour = 'black', fill = 'black', alpha = 0.7, size = 0.8) +
  annotate(geom = 'rect', xmin = 5.8, xmax = 6.8, ymin = 1.45, ymax = 4.2, colour = 'black', fill = 'black', alpha = 0.2) +
  geom_point(aes(x = x, y = y), data = Punto, size = 1.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  geom_point(aes(x = x, y = y), data = Puntos, size = 0.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  annotate(geom = 'text', x = 3.1, y = 3.0, label = 'BLUP', size = 4.6, angle = 90, colour = 'black') +
  
  geom_curve(x = 7.1, xend = 8.6, y = 2.825, yend = 2.825, arrow = arrow(length = unit(0.08, 'inch')), size = 0.5, color = 'black', curvature = 0.0, linetype = 'dashed') +
  annotate(geom = 'text', x = 9.4, y = 2.825, label = 'EBV', size = 4.8, colour = 'black') +
  
  scale_x_continuous(limits = c(1.0, 11.0)) +
  scale_y_continuous(limits = c(0.45, 10.0)) +
  
  theme_bw() +
  labs(title = 'BLUP') +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 11, face = 'bold')) -> ablup

Punto <- data.frame(x = c(8.025, 8.025), y = c(7.4, 1.4))
Puntos <- data.frame(x = c(8.025, 7.725, 8.325, 7.825, 8.225), y = c(9.0, 9.0, 9.0, 8.6, 8.6))
Puntos_2 <- data.frame(x = c(8.025, 7.725, 8.325, 7.825, 8.225), y = c(3.0, 3.0, 3.0, 2.6, 2.6))

data.frame(
  x = c(6.225, 6.225), y = c(6.7, 0.5)
  ) %>%
  ggplot(aes(x0 = x, y0 = y, r = 0.8)) +
  #geom_blank() +
  
  annotate(geom = 'rect', xmin = 0.5, xmax = 2.75, ymin = 6.0, ymax = 9.5, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'text', x = 1.625, y = 7.75, label = 'A', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 0.0, y = 7.75, label = 'Matriz A', size = 3.6, angle = 90, colour = 'black') +
  
  geom_curve(x = 3.05, xend = 4.45, y = 7.75, yend = 7.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.2, color = 'black', curvature = 0.0) +
  annotate(geom = 'rect', xmin = 5.225, xmax = 7.225, ymin = 9.2, ymax = 7.2, colour = 'black', fill = 'black', alpha = 0.4) +
  annotate(geom = 'rect', xmin = 6.125, xmax = 6.325, ymin = 7.2, ymax = 6.7, colour = 'black', fill = 'black', alpha = 0.7) +
  geom_circle(aes(x0 = x, y0 = y, r = 0.2), colour = 'black', fill = 'black', alpha = 0.7, size = 0.8) +
  annotate(geom = 'text', x = 4.85, y = 7.75, label = 'BLUP', size = 2.8, angle = 90, colour = 'black') +
  annotate(geom = 'rect', xmin = 7.525, xmax = 8.525, ymin = 6.65, ymax = 9.4, colour = 'black', fill = 'black', alpha = 0.2) +
  geom_point(aes(x = x, y = y), data = Punto, size = 1.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  geom_point(aes(x = x, y = y), data = Puntos, size = 0.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  
  geom_curve(x = 8.825, xend = 10.325, y = 7.75, yend = 7.75, arrow = arrow(length = unit(0.08, 'inch')), size = 0.5, color = 'black', curvature = 0.0, linetype = 'dashed') +
  annotate(geom = 'text', x = 11.35, y = 7.75, label = 'EBV', size = 3.8, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 0.75, xmax = 2.25, ymin = 0.5, ymax = 2.5, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'text', x = 1.5, y = 1.5, label = 'G', size = 3.4, colour = 'black') +
  annotate(geom = 'text', x = 0.25, y = 1.5, label = 'Matriz G', size = 3.6, angle = 90, colour = 'black') +
  annotate(geom = 'rect', xmin = 5.225, xmax = 7.225, ymin = 3.2, ymax = 1.2, colour = 'black', fill = 'black', alpha = 0.4) +
  annotate(geom = 'rect', xmin = 6.125, xmax = 6.325, ymin = 1.2, ymax = 0.7, colour = 'black', fill = 'black', alpha = 0.7) +
  annotate(geom = 'text', x = 4.85, y = 1.5, label = 'GBLUP', size = 2.8, angle = 90, colour = 'black') +
  annotate(geom = 'rect', xmin = 7.525, xmax = 8.525, ymin = 0.65, ymax = 3.4, colour = 'black', fill = 'black', alpha = 0.2) +
  geom_point(aes(x = x, y = y), data = Punto, size = 1.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  geom_point(aes(x = x, y = y), data = Puntos_2, size = 0.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  
  geom_curve(x = 8.825, xend = 10.125, y = 1.5, yend = 1.5, arrow = arrow(length = unit(0.08, 'inch')), size = 0.5, color = 'black', curvature = 0.0, linetype = 'dashed') +
  annotate(geom = 'text', x = 11.45, y = 1.5, label = 'GEBV', size = 3.8, colour = 'black') +
  geom_curve(x = 2.45, xend = 4.45, y = 1.5, yend = 1.5, arrow = arrow(length = unit(0.05, 'inch')), size = 0.2, color = 'black', curvature = 0.0) +
  geom_curve(x = 11.15, xend = 6.425, y = 7.25, yend = 3.5, arrow = arrow(length = unit(0.05, 'inch')), size = 0.2, color = 'black', curvature = 0.0) +
  
  annotate(geom = 'text', x = 11.45, y = 5.75, label = 'Pseudo', size = 3.8, colour = 'black') +
  annotate(geom = 'text', x = 11.45, y = 4.95, label = 'observaciones', size = 3.8, colour = 'black') +
  
  scale_x_continuous(limits = c(-1.0, 15.01)) +
  scale_y_continuous(limits = c(-1.5, 11.0)) +
  
  theme_bw() +
  labs(title = 'GBLUP') +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 11, face = 'bold')) -> gblup

Punto <- data.frame(x = 6.3, y = 0.8)
Puntos <- data.frame(x = c(6.3, 6.0, 6.6, 6.15, 6.45), y = c(1.8, 1.8, 1.8, 1.4, 1.4))

data.frame(
  x = 4.5, y = 0.5
  ) %>%
  ggplot(aes(x0 = x, y0 = y, r = 0.8)) +
  #geom_blank() +
  
  annotate(geom = 'rect', xmin = 1.5, xmax = 4.25, ymin = 7.5, ymax = 9.5, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'text', x = 2.875, y = 8.5, label = 'A', size = 6.4, colour = 'black') +
  annotate(geom = 'text', x = 1.1, y = 8.5, label = 'Matriz A', size = 4.6, angle = 90, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 7.0, xmax = 8.75, ymin = 7.75, ymax = 9.0, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'text', x = 7.875, y = 8.375, label = 'G', size = 6.4, colour = 'black') +
  annotate(geom = 'text', x = 6.6, y = 8.375, label = 'Matriz G', size = 4.6, angle = 90, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1.5, xmax = 4.25, ymin = 3.75, ymax = 5.75, colour = 'black', fill = 'white', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 2.3, xmax = 4.05, ymin = 3.95, ymax = 5.05, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'text', x = 1.1, y = 4.75, label = 'Matriz H', size = 4.6, angle = 90, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 3.5, xmax = 5.5, ymin = 1.8, ymax = 0.8, colour = 'black', fill = 'black', alpha = 0.4) +
  annotate(geom = 'rect', xmin = 4.4, xmax = 4.6, ymin = 0.8, ymax = 0.5, colour = 'black', fill = 'black', alpha = 0.7) +
  geom_circle(aes(x0 = x, y0 = y, r = 0.2), colour = 'black', fill = 'black', alpha = 0.7, size = 0.7) +
  
  annotate(geom = 'rect', xmin = 5.8, xmax = 6.8, ymin = 0.3, ymax = 2.0, colour = 'black', fill = 'black', alpha = 0.2) +
  geom_point(aes(x = x, y = y), data = Punto, size = 1.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  geom_point(aes(x = x, y = y), data = Puntos, size = 0.6, shape = 21, color = 'black', fill = 'black', alpha = 0.9) +
  annotate(geom = 'text', x = 3.1, y = 1.0, label = 'ssGBLUP', size = 4.6, angle = 90, colour = 'black') +
  
  geom_curve(x = 7.1, xend = 8.2, y = 1.0, yend = 1.0, arrow = arrow(length = unit(0.08, 'inch')), size = 0.5, color = 'black', curvature = 0.0, linetype = 'dashed') +
  annotate(geom = 'text', x = 9.4, y = 1.2, label = 'EBV', size = 4.8, colour = 'black') +
  annotate(geom = 'text', x = 9.4, y = 0.8, label = 'GEBV', size = 4.8, colour = 'black') +
  
  geom_curve(x = 2.875, xend = 2.875, y = 7.3, yend = 6.05, arrow = arrow(length = unit(0.05, 'inch')), size = 0.5, color = 'black', curvature = 0.0, linetype = 'solid') +
  geom_curve(x = 7.875, xend = 4.55, y = 7.45, yend = 4.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.5, color = 'black', curvature = 0.0, linetype = 'solid') +
  geom_curve(x = 2.875, xend = 3.95, y = 3.45, yend = 2.1, arrow = arrow(length = unit(0.05, 'inch')), size = 0.5, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  scale_x_continuous(limits = c(0.45, 10.45)) +
  scale_y_continuous(limits = c(0.0, 9.5)) +
  
  theme_bw() +
  labs(title = 'ssGBLUP') +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 11, face = 'bold')) -> ssgblup

(ablup / gblup) | (ssgblup) -> BLUPs

knitr::include_graphics('figures/BLUPs.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.7:__ Esquema de comparación del BLUP, GBLUP y ssGBLUP. El GBLUP es un proceso de tres pasos en el que los individuos, con base en su información fenotípica y de pedigrí, son evaluados inicialmente mediante el BLUP; luego, a partir de los pseudo-fenotipos resultantes de esta evaluación inicial, se lleva a cabo un análisis genómico de los individuos genotipados mediante el GBLUP. En el ssGBLUP se simplifica este proceso al incorporar la información genómica (la matriz G) desde el primer paso.
:::

Empero, esta forma de implementar la selección genómica en múltiples pasos es tendente a cometer errores [@cite:14], además de presentar inconvenientes como son la perdida de información y la dificultad de generalizarse a caracteres múltiples y maternos [@cite:17; @cite:15]. Conscientes de esto, @cite:17 simplificaron el proceso de varios pasos al desarrollar un método de selección genómica, en el que los fenotipos de los individuos genotipados y no genotipados se analizan conjuntamente para predecir su EBV o GEBV [@cite:20; @cite:11], método el cual se denominó como mejor predictor lineal insesgado genómico de un solo paso (ssGBLUP).

En el ssGBLUP se dispone de una matriz de parentesco genómica de individuos genotipados y no genotipados, denominada como matriz de parentesco combinada o matriz H (Figura 1.7). Esta matriz se obtiene combinando información de parentesco basado en marcadores de ADN (matriz G) entre individuos genotipados, e información de parentesco basado en pedigríes (matiz A) entre individuos genotipados y no genotipados [@cite:20]. Con ello, el proceso anterior de múltiples pasos tiende a simplificarse al incorporar la información genómica desde el primer paso [@cite:15; @cite:16], sin la necesidad del calculo posterior de pseudo-fenotipos [@cite:18].

El proceso de construcción de la matriz H es simple (Recuadro 1.1). De acuerdo a @cite:31, el parentesco genómico de los individuos no genotipados se estima a partir de los que sí lo estan, usando un procedimiento de regresión lineal que predice los genotipos no observados como combinaciones lineales de los genotipos observados con coeficientes de regresión derivados de las relaciones basadas en el pedigrí.

<!--

```{=latex}
\blandscape
```

-->

:::: {.infobox data-latex=""}

__Recuadro 1.1__

Conociendo que la matriz $H$ equivale a:

\begin{align*}
\begin{bmatrix}
var(g_{1}) & cov(g_{1}, g_{2}) \\ 
cov(g_{2}, g_{1}) & var(g_{2)} 
\end{bmatrix}
\end{align*}

El desarrollo de las ecuaciones que conducen a la matriz $H$ y su posterior uso dentro de las ecuaciones del modelo mixto se explican a continuación.

Partiendo de un modelo GBLUP en el que no se incluyen efectos fijos, $y = Zg + e$, un modelo en el cual se incluyen tanto individuos genotipados como no genotipados puede ser de la forma:

\begin{align*}
y = Z \begin{bmatrix} g_{1} \\ g_{2} \end{bmatrix} + e,
\end{align*}

donde $g_{1}$ corresponde a los individuos no genotipados, y $g_{2}$ a los individuos genotipados. Esto es, el vector efectos del marcador en el fenotipo o valores de cría ($g$) es dividido en dos partes, una con los valores de cría de los individuos no genotipados ($g_{1}$) y otra con los valores de cría de los individuos genotipados ($g_{2}$).

Para estimar el parentesco genómico de los individuos no genotipados, sus valores de cría ($g_{1}$) se predicen a partir de los valores de cría de los individuos que si lo están ($g_{2}$), con base en la expresión:

\begin{align*}
g_{1} = cov(g_{1}, g_{2}) \times \left[ var(g_{2} \right]^{-1} \times g_{2} + e
\end{align*}

<!--
NOTA: para entender la expresión anterior se debe recordar la ecuación de regresión, la cual permite predecir una variable dependiente (y) en función de una variable independiente (x), o bien, predecir el valor aditivo de un toro en función del rendimiento lechero de sus hijas.

Para el caso del ssGBLUP, en el que se pretende predecir el valor aditivo de los individuos no genotipados (g1) en función de los individuos genotipados (g2), la ecuación de regresión, así como su expresión, serían de la siguiente forma:

\begin{align*}
b_{a_{1}, a_{2}} = \frac{\sigma_{a_{1}, a_{2}}}{\sigma_{a_{2}}^{2}} = \sigma_{a_{1}, a_{2}} \times \left[ \sigma_{a_{2}}^{2}^{-1} \right]
\end{align*}

Luego:

\begin{align*}
a_{1} = \sigma_{a_{1}, a_{2}} \times \left[ \sigma_{a_{2}}^{2} \right]^{-1} \times a_{2} + e
\end{align*}
-->

Sabiendo que la matriz de parentesco en base al pedigrí ($A$) puede descomponerse como $\begin{bmatrix} A_{11} & A_{12} \\ A_{21} & A_{22} \end{bmatrix}$, donde $A_{11}$ y $A_{22}$ corresponden, respectivamente, a las matrices de parentesco en base al pedigrí de los individuos no genotipados y genotipados (o bien, la varianza de sus respectivos valores  de cría), y $A_{12}$ = $A_{21}$ corresponden a la matriz de parentesco en base al pedigrí entre individuos genotipados y no genotipados (o bien, la covarianza de sus valores de cría), la expresión anterior puede reescribirse de la siguiente forma:

\begin{align*}
g_{1} = A_{12} \times A_{22}^{-1} \times g_{2} + e
\end{align*}

Luego la expresión anterior en términos de varianza:

\begin{align*}
var(g_{1}) = var(A_{12} \times A_{22}^{-1} \times g_{2}) + var(e)
\end{align*}

Con un poco de algebra, finalmete se tendía la expresión correspondiente a $var(g_{1})$:

\begin{align*}
var(g_{1}) = A_{11} + A_{12} \times A_{22}^{-1} \times G - A_{22} \times A_{22}^{-1} \times A_{21}
\end{align*}

En relación a la expresión $var(g_{2})$, esta sería igual a:

\begin{align*}
var(g_{2}) = G
\end{align*}

Por último, la expresión $cov(g_{1}, g_{2})$, equivaldría a:

\begin{align*}
cov(g_{1}, g_{2}) = cov(A_{12} \times A_{22}^{-1} \times g_{2} + e, g_{2})
\end{align*}

Qué con un poco de algebra, equilvadría a:

\begin{align*}
cov(g_{1}, g_{2}) = A_{12} \times A_{22}^{-1} \times G
\end{align*}

Finalmente, la matriz que contiene las relaciones conjuntas de individuos genotipados y no genotipados sería:

\begin{align*}
H =
\begin{bmatrix}
A_{11} + A_{12} \times A_{22}^{-1} \times G - A_{22} \times A_{22}^{-1} \times A_{21} & A_{12} \times A_{22}^{-1} \times G \\ 
G \times A_{22}^{-1} \times A_{12}' & G 
\end{bmatrix}
\end{align*}

Una vez obtenida la matriz H, se obtiene su inversa ($H^{-1}$), y el modelo de selección genómica se puede resolver mediante un modelo lineal mixto:

\begin{align*}
\begin{bmatrix}
X'X & X'Z \\
Z'X & Z'Z + H^{-1} \lambda
\end{bmatrix}
\begin{bmatrix}
\hat{b} \\
\hat{g}
\end{bmatrix}
=
\begin{bmatrix}
X'y \\
Z'y
\end{bmatrix}
,
\end{align*}
::::
<!--

```{=latex}
\newpage
\elandscape
```
-->
Al ser una forma de BLUP o GBLUP en el que la matriz A y G, respectivamente, es sustituida por la matriz H [@cite:17; @cite:15; @cite:21], el ssGBLUP se puede adecuar con facilidad a caracteres múltiples y maternos [@cite:21], además se adapta también a las herramientas informáticas ya desarrolladas en base al BLUP y GBLUP [@cite:22]. Este hecho hace del ssGBLUP un método de uso rutinario para la selección genómica, donde ha demostrado que produce una predicción más precisa en comparación a los métodos BLUP y GBLUP ya mencionados [@cite:14; @cite:19; @cite:18].

### Factores que afectan la habilidad predictiva de la selección genómica

La precisión con la que se predice el GEBV es el factor más importante que determina el éxito de la selección genómica [@cite:6]. Dicha precisión se suele evaluar como la correlación entre el GEBV predicho y el valor fenotípico real u observado, lo que se denomina como habilidad predictiva [@cite:45]. Así mismo, la habilidad predictiva de la selección genómica depende de las características de los datos genotípicos, esto es, el número de individuos genotipados y la densidad del marcador [@cite:45; @cite:7].

En relación a la densidad del marcador, hoy en día se conoce que la habilidad predictiva de la selección genómica disminuye a menor número de marcadores de ADN en desequilibrio de ligamiento con el QTL <!-- NOTA: el desequilibrio de ligamiento entre los marcadores y el QTL es el factor clave del exito de la selecció genómica. Como la selección genómica se basa en el desequilibrio de ligamiento entre el marcador de ADN y el QTL, es necesario gran cantidad de marcadores para garantizar que si haya una asociación con el QTL. --> [@cite:10; @cite:45]. Así mismo, los estudios de simulación indican que a mayor número de marcadores se mejora la habilidad predictiva de la selección genómica [@cite:7]. Sin embargo, el aumento de la precisión puede alcanzar su limite a medida que se aumenta la densidad del marcador [@cite:3; @cite:37; @cite:45], por lo cual se recomienda mediante simulación evaluar el efecto del número de marcadores de ADN en la precisión de la predicción, antes de implementar la selección genómica en escenarios prácticos [@cite:47].

En cuanto al número de individuos genotipados, la habilidad predictiva de la selección genómica es mayor a medida que aumenta su proporción. Esto lo evidencian @cite:6, @cite:3, y @cite:10, quienes coinciden en afirmar que a mayor tamaño de la población de entrenamiento, mayor sera la precisión de la predicción del GEBV.

<!--
### Machine learning y deep learning


NOTA: DEPRONTO ESTO LO PUEDO COLOCAR CUANDO HABLE DEL ML Y DL. Todos los enfoques de regresión mencionados anteriormente asumen una relación lineal entre los marcadores de todo el genoma y los rasgos fenotípicos. Por tanto, capturan los efectos aditivos de los marcadores de todo el genoma y son adecuados para la predicción de rasgos fenotípicos en poblaciones consanguíneas.

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

data.frame(
  x = c(0.0:10.0), y = c(0.0:10.0)
  ) %>%
  ggplot(aes(x, y)) +
  #geom_blank() +
  
  annotate(geom = 'rect', xmin = 3.0, xmax = 7.0, ymin = 7.0, ymax = 9.0, colour = 'yellow', fill = 'yellow', alpha = 0.2) +
  annotate(geom = 'text', x = 5.0, y = 8.355, label = 'Modelo de', size = 5.0, colour = 'black') +
  annotate(geom = 'text', x = 5.0, y = 7.625, label = ' clasificación', size = 5.0, colour = 'black') +
  annotate(geom = 'text', x = 2.0, y = 8.25, label = 'Genotipo', size = 4.6, colour = 'black') +
  geom_curve(x = 1.2, xend = 2.8, y = 7.75, yend = 7.75, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  annotate(geom = 'rect', xmin = 7.9, xmax = 8.5, ymin = 6.8, ymax = 9.2, colour = 'black', fill = 'white', linetype = 'twodash') +
  annotate(geom = 'text', x = 8.2, y = 8.0, label = 'Prueba', angle = 90, size = 5.0, colour = 'black') +
  geom_curve(x = 7.7, xend = 7.3, y = 8.0, yend = 8.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'solid') +
  
  geom_curve(x = 5.0, xend = 5.0, y = 6.8, yend = 6.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'rect', xmin = 3.9, xmax = 6.1, ymin = 4.8, ymax = 5.8, colour = 'gray41', fill = 'gray41', alpha = 0.2) +
  annotate(geom = 'text', x = 5.0, y = 5.3, label = 'Moderado', size = 3.8, colour = 'black') +
  
  geom_curve(x = 5.0, xend = 2.0, y = 6.8, yend = 6.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'rect', xmin = 0.9, xmax = 3.1, ymin = 4.8, ymax = 5.8, colour = 'gray81', fill = 'gray81', alpha = 0.2) +
  annotate(geom = 'text', x = 2.0, y = 5.3, label = 'Bueno', size = 5.0, colour = 'black') +
  
  geom_curve(x = 5.0, xend = 8.0, y = 6.8, yend = 6.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'rect', xmin = 6.9, xmax = 9.1, ymin = 4.8, ymax = 5.8, colour = 'gray1', fill = 'gray1', alpha = 0.2) +
  annotate(geom = 'text', x = 8.0, y = 5.3, label = 'Malo', size = 5.0, colour = 'black') +
  
  scale_x_continuous(limits = c(0.0, 10.0)) +
  scale_y_continuous(limits = c(4.3, 9.5)) +
  
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank()) -> Mod_ML

Punto_1 <- data.frame(x = c(0.5, 0.5, 0.5), y = c(10.0, 5.5, 1.0))
Punto_2 <- data.frame(x = c(3.0, 3.0, 3.0, 3.0), y = c(12.25, 7.75, 3.25, -0.5))
Punto_3 <- data.frame(x = 5.5, y = 5.5)

data.frame(
  x = c(-3.45:8.45), y = c(-1.0:10.0)
  ) %>%
  ggplot(aes(x, y)) +
  #geom_blank() +
  
  geom_point(aes(x = x, y = y), data = Punto_1, size = 11.6, shape = 21, color = 'yellow', fill = 'yellow', alpha = 0.4) +
  geom_point(aes(x = x, y = y), data = Punto_2, size = 11.6, shape = 21, color = 'cyan', fill = 'cyan', alpha = 0.4) +
  geom_point(aes(x = x, y = y), data = Punto_3, size = 11.6, shape = 21, color = 'red', fill = 'red', alpha = 0.4) +
  
  geom_curve(x = -0.5, xend = 0.0, y = 10.5, yend = 10.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'text', x = -0.8, y = 10.5, label = 'SNP 1', family = 'gochi', size = 3.8, colour = 'black', angle = 90) +
  
  geom_curve(x = -0.5, xend = 0.0, y = 5.5, yend = 5.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'text', x = -0.8, y = 5.5, label = 'SNP 2', family = 'gochi', size = 3.8, colour = 'black', angle = 90) +
  
  geom_curve(x = -0.5, xend = 0.0, y = 1.0, yend = 1.0, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'text', x = -0.8, y = 1.0, label = 'SNP 3', family = 'gochi', size = 3.8, colour = 'black', angle = 90) +
  
  geom_curve(x = 6.0, xend = 6.5, y = 5.5, yend = 5.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.8, color = 'black', curvature = 0.0, linetype = 'twodash') +
  annotate(geom = 'text', x = 6.8, y = 5.5, label = 'Fenotipo', family = 'gochi', size = 4.2, colour = 'black', angle = 90) +
  
  annotate(geom = 'text', x = 0.5, y = -1.4, label = 'Entrada', size = 3.8, colour = 'black') +
  annotate(geom = 'text', x = 3.0, y = -2.85, label = 'Oculta', size = 3.8, colour = 'black') +
  annotate(geom = 'text', x = 5.5, y = 2.9, label = 'Salida', size = 3.8, colour = 'black') +
  
  geom_curve(x = 0.8, xend = 2.7, y = 10.5, yend = 12.25, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 10.5, yend = 7.75, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 10.5, yend = 3.25, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 10.5, yend = -0.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 0.8, xend = 2.7, y = 5.5, yend = 12.25, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 5.5, yend = 7.75, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 5.5, yend = 3.25, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 5.5, yend = -0.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 0.8, xend = 2.7, y = 1.0, yend = 12.25, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 1.0, yend = 7.75, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 1.0, yend = 3.25, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 0.8, xend = 2.7, y = 1.0, yend = -0.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 3.3, xend = 5.2, y = 12.25, yend = 5.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 3.3, xend = 5.2, y = 7.75, yend = 5.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 3.3, xend = 5.2, y = 3.25, yend = 5.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 3.3, xend = 5.2, y = -0.5, yend = 5.5, arrow = arrow(length = unit(0.1, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  scale_x_continuous(limits = c(-1.05, 6.95)) +
  scale_y_continuous(limits = c(-3.75, 14.0)) +
  
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank()) -> Mod_DL

(Mod_ML / Mod_DL) -> ML

knitr::include_graphics('figures/Mod_ML.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.7:__ . Figura adaptada de @cite:7.
:::

-->

## Breve descripción de la mejora genética en arroz

### Diferencias de la mejora genética en animales y en plantas

Tras la domesticación de animales y el cultivo de plantas, la especie humana consiguió producir animales y plantas mejoradas. Esto a partir de la selección artificial. La clave del éxito de los antiguos domesticadores y cultivadores consistió en cruzar individuos portadores de caracteres deseables, al comprender que los descendientes podrían heredar estas características, pese a que para esos tiempos se desconocían los mecanismos biológicos de la herencia [@cite:43]. Hoy en día, se conoce como mejora genética al proceso de mejorar los caracteres fenotípicos deseables en animales y plantas mediante selección artificial [@cite:7], siendo la misma reconocida como una intrincada integración de ciencia y practicidad [@cite:42].

En términos generales, la mejora genética se puede organizar en tres procesos, siendo estos la producción de variación genética, la selección entre la variación y la multiplicación para uso comercial (Figura 1.8).

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE}

Triangulo <- data.frame(x = c(0.5, 7.5, 4.0), y = c(0.5, 0.5, 7.5))
Punto <- data.frame(x = 4.0, y = 5.8)

data.frame(
  x = c(0.0:10.0), y = c(0.0:10.0)
  ) %>%
  ggplot() +
  #geom_blank() +
  
  geom_polygon(data = Triangulo, aes(x = x, y = y), color = 'yellow', fill = 'yellow', alpha = 0.1) +
  
  geom_point(aes(x = x, y = y), data = Punto, size = 34.6, shape = 1, color = 'black') +
  
  geom_curve(x = 5.15, xend = 5.0, y = 4.975, yend = 4.925, arrow = arrow(length = unit(0.08, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  annotate(geom = 'rect', xmin = 3.0, xmax = 5.0, ymin = 4.45, ymax = 5.05, colour = 'black', fill = 'white') +
  annotate(geom = 'text', x = 4.0, y = 4.75, label = 'Selección', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'rect', xmin = 1.0, xmax = 3.0, ymin = 6.05, ymax = 5.45, colour = 'black', fill = 'white') +
  annotate(geom = 'text', x = 2.0, y = 5.75, label = 'Selección', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'rect', xmin = 1.5, xmax = 3.5, ymin = 7.05, ymax = 6.45, colour = 'black', fill = 'white') +
  annotate(geom = 'text', x = 2.5, y = 6.75, label = 'Selección', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'rect', xmin = 4.5, xmax = 6.5, ymin = 7.05, ymax = 6.45, colour = 'black', fill = 'white') +
  annotate(geom = 'text', x = 5.5, y = 6.75, label = 'Selección', family = 'gochi', size = 3.2, colour = 'black') +
  annotate(geom = 'rect', xmin = 5.0, xmax = 7.0, ymin = 6.05, ymax = 5.45, colour = 'black', fill = 'white') +
  annotate(geom = 'text', x = 6.0, y = 5.75, label = 'Selección', family = 'gochi', size = 3.2, colour = 'black') +
  
  annotate(geom = 'text', x = 0.25, y = 5.75, label = 'Núcleos de selección', size = 3.4, colour = 'black', angle = 90) +
  annotate(geom = 'text', x = 0.25, y = 2.475, label = 'Multiplicadoras', size = 3.4, colour = 'black', angle = 90) +
  
  annotate(geom = 'segment', x = 7.6, xend = 7.6, y = 4.45, yend = 7.5, colour = 'black', linetype = 'solid', size = 0.4) +
  annotate(geom = 'text', x = 7.9, y = 5.975, label = 'Población mejorada', size = 3.4, colour = 'black', angle = 90) +
  
  annotate(geom = 'segment', x = 7.6, xend = 7.6, y = 4.05, yend = 0.5, colour = 'black', linetype = 'solid', size = 0.4) +
  annotate(geom = 'text', x = 7.9, y = 2.425, label = 'Desarrollo de producto', size = 3.4, colour = 'black', angle = 90) +

  scale_x_continuous(limits = c(-0.25, 8.35)) +
  scale_y_continuous(limits = c(0.0, 8.0)) +
  
  theme_bw() +
  labs(title = 'Mejora genética en animales') +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 11, face = 'bold')) -> Mej_anim

data.frame(
  x = c(0.0:10.0), y = c(0.0:10.0)
  ) %>%
  ggplot() +
  #geom_blank() +
  
  annotate(geom = 'text', x = 0.75, y = 11.5, label = 'Año', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 10.5, label = '1', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 9.5, label = '2', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 8.5, label = '3', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 7.5, label = '4', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 6.5, label = '5', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 5.5, label = '6', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 4.5, label = '7', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 3.5, label = '8', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 2.5, label = '9', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 0.75, y = 1.5, label = '0', size = 3.2, colour = 'black') +
  
  annotate(geom = 'text', x = 2.75, y = 11.5, label = 'Generación', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 9.5, label = 'F1', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 8.5, label = 'F2', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 7.5, label = 'F3', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 6.5, label = 'F4', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 5.5, label = 'F5', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 4.5, label = 'F6', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 3.5, label = 'F7', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 2.5, label = 'F8', size = 3.2, colour = 'black') +
  annotate(geom = 'text', x = 2.75, y = 1.5, label = 'F9', size = 3.2, colour = 'black') +
  
  annotate(geom = 'text', x = 5.75, y = 10.5, label = 'P1 x P2', family = 'gochi', size = 3.4, colour = 'black') +
  annotate(geom = 'rect', xmin = 4.75, xmax = 6.75, ymin = 9.25, ymax = 9.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 3.75, xmax = 7.75, ymin = 8.25, ymax = 8.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 4.05, xmax = 8.05, ymin = 7.25, ymax = 7.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 3.75, xmax = 3.95, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 4.45, xmax = 4.65, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 4.95, xmax = 5.15, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 5.45, xmax = 5.65, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 6.05, xmax = 6.25, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 6.55, xmax = 6.75, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 7.25, xmax = 7.45, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 7.75, xmax = 7.95, ymin = 6.25, ymax = 6.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 4.15, xmax = 4.65, ymin = 5.25, ymax = 5.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 5.35, xmax = 5.85, ymin = 5.25, ymax = 5.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 6.15, xmax = 6.65, ymin = 5.25, ymax = 5.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 6.95, xmax = 7.45, ymin = 5.25, ymax = 5.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 7.75, xmax = 8.25, ymin = 5.25, ymax = 5.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 5.15, xmax = 5.65, ymin = 4.25, ymax = 4.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 5.95, xmax = 6.45, ymin = 4.25, ymax = 4.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 6.75, xmax = 7.25, ymin = 4.25, ymax = 4.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 7.55, xmax = 8.05, ymin = 4.25, ymax = 4.75, colour = 'cyan', fill = 'cyan', alpha = 0.7) +
  annotate(geom = 'rect', xmin = 6.85, xmax = 7.35, ymin = 3.25, ymax = 3.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 7.65, xmax = 8.15, ymin = 3.25, ymax = 3.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 6.85, xmax = 7.35, ymin = 2.25, ymax = 2.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 7.65, xmax = 8.15, ymin = 2.25, ymax = 2.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  annotate(geom = 'rect', xmin = 7.55, xmax = 8.05, ymin = 1.25, ymax = 1.75, colour = 'cyan', fill = 'cyan', alpha = 0.2) +
  
  geom_curve(x = 5.75, xend = 5.75, y = 10.2, yend = 9.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 5.75, xend = 5.75, y = 9.25, yend = 8.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 4.5, xend = 4.95, y = 8.5, yend = 7.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 5.45, xend = 5.45, y = 8.35, yend = 7.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 5.85, xend = 6.75, y = 8.35, yend = 7.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 4.15, xend = 4.55, y = 7.35, yend = 6.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 6.45, xend = 6.65, y = 7.35, yend = 6.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 7.85, xend = 7.85, y = 7.35, yend = 6.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 3.85, xend = 4.4, y = 6.25, yend = 5.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 5.55, xend = 5.6, y = 6.25, yend = 5.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 6.15, xend = 6.4, y = 6.25, yend = 5.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 7.35, xend = 7.2, y = 6.25, yend = 5.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 4.4, xend = 5.4, y = 5.25, yend = 4.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 5.6, xend = 6.2, y = 5.25, yend = 4.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 6.4, xend = 7.0, y = 5.25, yend = 4.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 7.2, xend = 7.8, y = 5.25, yend = 4.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 7.0, xend = 7.1, y = 4.25, yend = 3.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 7.8, xend = 7.9, y = 4.25, yend = 3.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 7.1, xend = 7.1, y = 3.25, yend = 2.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 7.9, xend = 7.9, y = 3.25, yend = 2.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  geom_curve(x = 7.9, xend = 7.8, y = 2.25, yend = 1.75, arrow = arrow(length = unit(0.05, 'inch')), size = 0.1, color = 'black', curvature = 0.0) +
  
  annotate(geom = 'segment', x = 9.0, xend = 9.0, y = 1.5, yend = 10.5, colour = 'black', linetype = 'dashed', size = 0.4) +
  geom_curve(x = 9.0, xend = 7.0, y = 10.5, yend = 10.5, arrow = arrow(length = unit(0.05, 'inch')), linetype = 'dashed', size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 8.2, xend = 9.0, y = 1.5, yend = 1.5, arrow = arrow(length = unit(0.05, 'inch')), linetype = 'dashed', size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 8.25, xend = 9.0, y = 3.5, yend = 3.5, arrow = arrow(length = unit(0.05, 'inch')), linetype = 'dashed', size = 0.1, color = 'black', curvature = 0.0) +
  geom_curve(x = 8.15, xend = 9.0, y = 6.5, yend = 6.5, arrow = arrow(length = unit(0.05, 'inch')), linetype = 'dashed', size = 0.1, color = 'black', curvature = 0.0) +
  
  annotate(geom = 'text', x = 9.5, y = 6.0, label = 'Núcleos de selección', size = 3.4, colour = 'black', angle = 90) +
  
  annotate(geom = 'segment', x = 0.48, xend = 0.48, y = 10.7, yend = 9.3, colour = 'black', linetype = 'solid', size = 0.4) +
  annotate(geom = 'text', x = 0.04, y = 10.0, label = 'Población mejorada', size = 3.4, colour = 'black', angle = 90) +
  
  annotate(geom = 'segment', x = 0.48, xend = 0.48, y = 8.7, yend = 1.3, colour = 'black', linetype = 'solid', size = 0.4) +
  annotate(geom = 'text', x = 0.04, y = 5.0, label = 'Desarrollo de producto', size = 3.4, colour = 'black', angle = 90) +
  
  scale_x_continuous(limits = c(-0.4, 10.25)) +
  scale_y_continuous(limits = c(1.0, 12.0)) +
  
  theme_bw() +
  labs(title = 'Mejora genética en plantas') +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 11, face = 'bold')) -> Mej_plant


(Mej_anim | Mej_plant) -> Mej_anim_plant

knitr::include_graphics('figures/Mej_Anim_Plan.pdf', auto_pdf = TRUE)
```

::: {.center data-latex=""}
__Figura 1.8:__ Esquema de la mejora genética en animales y en plantas. Figura adaptada de @cite:44.
:::

El primer requisito en la mejora genética, como se mencionó en el párrafo anterior, consiste en producir variación genética de los caracteres que se desean a mejorar. Tanto en animales como en plantas, la producción de variación genética se da a través del apareamiento de individuos cuya expresión de caracteres es deseable [@cite:42]. De esta forma, mediante el proceso natural de reproducción sexual, se puede obtener una descendencia que contiene genes de interés heredados de los dos progenitores.

Una vez producida la variación genética, es necesario seleccionar individuos con mejor expresión de caracteres. Tanto en animales como en plantas, la selección se lleva a cabo de forma recurrente (en los denominados núcleos de selección) con la finalidad de aumentar la frecuencia de genes favorables. Sin embargo, los métodos de selección históricamente usados han sido distintos. Por un lado, en plantas se ha utilizado principalmente la MAS con el fin de identificar e incorporar genes beneficiosos, favoreciendo así que genes con efectos moderados a grandes hayan sido explotados más ampliamente en plantas que en animales. Por otro lado, en animales la mayoría de caracteres económicamente importantes han sido cuantitativos y complejos, lo cual obligo a los mejoradores genéticos a utilizar enfoques biométricos para predecir el EBV mediante la combinación de información fenotípica y de pedigrí (propiamente el BLUP), y con ello tomar las decisiones de selección [@cite:44].

Justo después de aumentar la frecuencia de genes deseables, es necesario multiplicar o difundir el mérito genético medio obtenido de la población mejorada, y así facilitar que en las granjas comerciales los agricultores produzcan los caracteres mejorados [@cite:21]. Según @cite:44, una diferencia importante entre la mejora genética de animales y plantas, es que en animales la mejora difundida a las granjas comerciales no se recicla a los núcleos de selección, mientras que en plantas, al darle importancia a la selección de productos mejorados en forma de variedades vegetales, dichas variedades pueden ser usadas como progenitores en un ciclo nuevo de cultivo.
<!--
Otra diferencia entre animales y plantas señalada por los mismos autores [@cite:44], son los caracteres limitados por el sexo. En animales pueden presentarse caracteres que no se pueden medir en un individuo (por ejemplo, la producción de leche en los machos), por lo cual se suele utilizar la información de sus familiares para predecir su fenotipo. Por lo contrario, en plantas no se presenta este problema de los caracteres limitados por el sexo.
-->

Por otro lado, desde el momento en que la selección genómica fue propuesta por @cite:8, se adapto rápidamente a la mejora genética en animales, principalmente al sector ganadero. Sin embargo, el uso de la selección genómica en plantas se ha quedado atrás [@cite:46] y son varias las razones de ello:

1- Los métodos de mejora genética en animales y en plantas han divergido a lo largo de los años, lo cual implica que se requiera de tiempo para que los avances y las contribuciones realizadas en un campo se trasladen al otro [@cite:44].

2- El genoma de muchas especies de plantas es más compleja al genoma de los animales. Los animales al ser individuos diploides, aportan a la descendencia solo uno de sus dos alelos, por lo cual es más fácil predecir en ellos cuan efectiva sera la selección, al suponer que de los distintos componentes de la varianza genética solo se heredara la varianza debido a efectos aditivos (esto es, la heredabilidad en el sentido estricto). Caso contrario sucede en las plantas cuya respuesta a la selección puede implicar, en caso de que la especie sea poliploide o se haya propagado de forma vegetativa, otros tipos de interacción como la dominancia entre dos alelos [@cite:43].<!-- La situación se vuelve más complicada cuando se introducen los sistemas reproductivos más complejos de las plantas. Considere más a fondo la situación de mejoramiento de la papa descrita anteriormente. Una planta de patata puede cruzarse sexualmente para generar una progenie exogámica, que puede someterse a una selección basada en el fenotipo, un concepto similar a un esquema de cría de animales. Sin embargo, la utilidad de un toro de ganado seleccionado en un programa de reproducción lechera radica en su capacidad de aparearse con madres para generar hijas que puedan usarse en la producción lechera. Por lo tanto, su valor genético realmente está determinado por sus efectos genéticos aditivos, porque todas sus hijas portan solo uno de sus alelos. Por el contrario, si un mejorador de papa identifica una planta particularmente superior, esa planta puede propagarse vegetativamente mediante esquejes de tubérculos, y los agricultores pueden usar esos pedazos de tubérculos en la producción. Por tanto, la respuesta a la selección en este caso implica todo el genotipo de la planta que se propaga clonalmente, incluidos todos sus efectos aditivos y de dominancia. Entonces, la respuesta a esta selección es una función de la heredabilidad en sentido amplio, no la heredabilidad en sentido estricto en este caso. -->

3- Varios mejoradores genéticos de plantas argumentan que se pueden obtener algunos de los beneficios esperados de la selección genómica a través del uso de otros métodos [@cite:44].

4- Es costoso invertir en infraestructura computacional y de registro tanto de datos genotípicos como fenotípicos requeridos para implementar la selección genómica. El tamaño de las poblaciones en la cría de animales son mucho más pequeños que la mayoría de poblaciones en la cría de plantas. Si bien los costos de genotipado por individuo son cada vez más bajos, el costo total de genotipado al considerar todas las plantas es aún hoy en día demasiado alto para la mayoría de programas de mejora genética en plantas [@cite:46].

Pese a lo anterior, en la literatura científica (Tabla1.1) se evidencia el uso potencial de la selección genómica para mejorar el mérito genético medio por selección tanto en animales como en plantas. A pesar de sus diferencias, ambas disciplinas requieren de conceptos y herramientas similares de selección genómica. Por lo tanto, es de esperar que los mejoradores genéticos de animales y de plantas se beneficien del trabajo conjunto para solucionar aquellos problemas que les son comunes.

::: {.center data-latex=""}
__Tabla 1.1:__ .
:::

```{r, echo = FALSE, out.width = "100%", fig.align = 'center'}

tribble(
  ~'Especie', ~'Carácter', ~'Habilidad predictiva', ~'Modelo', ~'Referencia',
  '', '', '', '', ''
  ) %>%
  gt()
```

### Relevancia de la mejora genética en arroz

```{r, echo = FALSE, out.width = "100%", fig.align = 'center', fig.showtext = TRUE, message = FALSE, warning=FALSE}

Arroz <- read_delim(here('figures', 'datos_arroz_2.csv'), delim = ',')

Arroz_2 <- Arroz %>%
  mutate(
    Elemento = recode(
    .x = Elemento,
    'Alimentos' = 'Uso alimentario',
    'Elaboración' = 'Uso alimentario',
    'Exportaciones - Canditad' = 'Exportación',
    'Pienso' = 'Elaboración de pienso',
    'Producción' = 'Producción',
    'Semillas' = 'Uso como semilla',
    'Otro uso (no alimentario)' = 'Otro uso'
    )
  ) %>%
  select(Elemento, Año, Valor, Unidad) %>%
  group_by(Elemento) %>%
  summarise(Total = sum(Valor)) %>%
  ungroup() %>%
  pivot_wider(names_from = Elemento, values_from = Total) %>%
  select(-Producción)

Arroz_3 <- tribble(
  ~'Elaboración de pienso', ~'Exportación', ~'Otro uso', ~'Uso alimentario', ~'Uso como semilla',
  9413749, 	9413749, 	9413749, 	9413749, 	9413749,
  0, 0, 0, 0, 0
  ) # Se crea este conjunto de datos ya que se necesita, para hacer el gráfico de radar, la primera fila con el máximo valor (esto es, la producción total en miles de toneladas de arroz) y en la segunda fila el mínimo valor.

Arroz_4 <- bind_rows(Arroz_3, Arroz_2)

#radarchart(df = Arroz_4) # NOTA: El gráfico radar lo saque de este tutorial: https://www.datanovia.com/en/blog/beautiful-radar-chart-in-r-using-fmsb-and-ggplot-packages/

Graf_radar <- function(data,
                       color = 'yellow',
                       vlabels = colnames(data), 
                       vlcex = 2.4,
                       caxislabels = NULL, title = NULL, ...){
  radarchart(
    data, axistype = 1,
    # Diseño del poligono
    pcol = color, pfcol = scales::alpha(color, 0.4), plwd = 3.4, plty = 1.4,
    # Diseño de las líneas
    cglcol = 'grey', cglty = 1.4, cglwd = 2.8,
    # Diseño de los ejes
    axislabcol = 'grey', 
    # Diseño de las variables
    vlcex = vlcex, vlabels = vlabels,
    caxislabels = caxislabels, title = title, ...
    )
  }

#Graf_arroz_1 <- Graf_radar(data = Arroz_4)

Arroz_5 <- read_delim(here('figures', 'datos_arroz.csv'), delim = ',')

Graf_arroz_2 <- Arroz_5 %>%
  select(Elemento, Año, Valor, Unidad) %>%
  filter(Elemento == 'Producción') %>%
  group_by(Elemento, Año) %>%
  summarise(Total = sum(Valor, na.rm = TRUE)) %>%
  ungroup() %>%
  ggplot(data = ., aes(x = Año, y = Total, colour = Elemento, fill = Elemento)) +
  geom_area(alpha = 0.2, position = position_dodge(0.8), size = 1.2) +
  labs(title = 'Evolución de la producción de arroz') +
  scale_color_manual(values = c('yellow', 'cyan')) +
  scale_fill_manual(values = c('yellow', 'cyan')) +
  theme_bw() +
  theme(
    legend.position = 'none',
    axis.text.y = element_blank(),
    axis.text.x = element_text(size = 10),
    axis.ticks.y = element_blank(),
    axis.title = element_blank(),
    plot.title = element_text(size = 11, face = 'bold')
    )

a <- data.frame(
  x = c(1:10), y = c(1:10)
  ) %>%
  ggplot(aes(x, y)) +
  geom_blank() +
  labs(title = 'Distintos usos del arroz') +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size = 11, face = 'bold'))

Graf_arroz_1 <- readPNG(here('figures', 'Graf_arroz_1.png'), native = TRUE)

b <- a + 
  inset_element(p = Graf_arroz_1,
                left = 0.01,
                bottom = 0.01,
                right = 0.99,
                top = 0.99)

(Graf_arroz_2 | b) -> Graf_arroz

knitr::include_graphics('figures/Graf_arroz.pdf', auto_pdf = TRUE)
```